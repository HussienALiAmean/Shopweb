"use strict";(self.webpackChunkShop_web_Front=self.webpackChunkShop_web_Front||[]).push([[348],{348:(M,l,c)=>{c.r(l),c.d(l,{UserModule:()=>S});var d=c(6895),p=c(6115),t=c(1571),m=c(4069),g=c(1135);let h=(()=>{class r{constructor(){this.cart=[],this.cartSubject=new g.X([]),this.cart$=this.cartSubject.asObservable()}addToCart(e){const n=this.cart.find(i=>i.id===e.id);n?n.quantity+=1:this.cart.push({...e,quantity:1}),this.cartSubject.next(this.cart)}getCartItems(){return this.cart}updateCart(e){this.cart=e,this.cartSubject.next(this.cart)}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var a=c(433);function C(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"button",5),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.addToCart(s))}),t._uU(7," Add "),t.O4$(),t.TgZ(8,"svg",6),t._UZ(9,"path",7),t.qZA()()()()}if(2&r){const e=o.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.price)}}let f=(()=>{class r{constructor(e,n){this.productService=e,this.cartService=n,this.products=[],this.filteredProducts=[],this.searchQuery=""}ngOnInit(){this.productService.getAllProducts("/visible").subscribe(e=>{this.products=e,this.filteredProducts=e})}addToCart(e){this.cartService.addToCart(e)}filterProducts(){this.filteredProducts=this.products.filter(e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase()))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(m.M),t.Y36(h))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-products"]],decls:16,vars:2,consts:[[1,"container","mt-4"],[1,"form-group"],["type","text","placeholder","Search Products",1,"mb-2","form-control",3,"ngModel","ngModelChange","input"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-cart4"],["d","M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5M3.14 5l.5 2H5V5zM6 5v2h2V5zm3 0v2h2V5zm3 0v2h1.36l.5-2zm1.11 3H12v2h.61zM11 8H9v2h2zM8 8H6v2h2zM5 8H3.89l.5 2H5zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0m9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Products"),t.qZA(),t.TgZ(3,"div",1)(4,"input",2),t.NdJ("ngModelChange",function(s){return n.searchQuery=s})("input",function(){return n.filterProducts()}),t.qZA()(),t.TgZ(5,"table",3)(6,"thead")(7,"tr")(8,"th"),t._uU(9,"Name"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Price"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Add to Cart"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,C,10,2,"tr",4),t.qZA()()()),2&e&&(t.xp6(4),t.Q6J("ngModel",n.searchQuery),t.xp6(11),t.Q6J("ngForOf",n.filteredProducts))},dependencies:[d.sg,a.Fj,a.JJ,a.On]}),r})();var v=c(1800),Z=c(7628);function T(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"input",5),t.NdJ("ngModelChange",function(i){const u=t.CHM(e).$implicit;return t.KtG(u.quantity=i)})("change",function(){const s=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.updateQuantity(s,s.quantity))}),t.qZA()()()}if(2&r){const e=o.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.price),t.xp6(2),t.Q6J("ngModel",e.quantity)}}let b=(()=>{class r{constructor(e,n,i){this.cartService=e,this.orderService=n,this.authService=i,this.cart=[]}ngOnInit(){this.cartService.cart$.subscribe(e=>{this.cart=e})}updateQuantity(e,n){e.quantity=n,this.cartService.updateCart(this.cart)}getTotalPrice(){return this.cart.reduce((e,n)=>e+n.price*n.quantity,0)}submitOrder(){if(this.cart.length>0){const e=this.cart.map(n=>({ProductId:n.id,Quantity:n.quantity,TotalePrice:n.price*n.quantity}));this.orderService.createOrder(e).subscribe({next:n=>{console.log("Order submitted:",n),alert("Order submitted successfully!"),this.cartService.updateCart([])},error:n=>{console.log("Order submission error:",n.error),alert("There was an error submitting your order. : "+n.error+"  Please try again.")}})}}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(h),t.Y36(v.p),t.Y36(Z.e))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-cart"]],decls:20,vars:5,consts:[[1,"container","mt-4"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"total-price"],[1,"btn","btn-primary",3,"disabled","click"],["type","number","min","0",3,"ngModel","ngModelChange","change"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Cart"),t.qZA(),t.TgZ(3,"table",1)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"Item"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Price"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Quantity"),t.qZA()()(),t.TgZ(12,"tbody"),t.YNc(13,T,7,3,"tr",2),t.qZA()(),t.TgZ(14,"div",3)(15,"h3"),t._uU(16),t.ALo(17,"currency"),t.qZA()(),t.TgZ(18,"button",4),t.NdJ("click",function(){return n.submitOrder()}),t._uU(19,"Submit Order"),t.qZA()()),2&e&&(t.xp6(13),t.Q6J("ngForOf",n.cart),t.xp6(3),t.hij("Total: ",t.lcZ(17,3,n.getTotalPrice()),""),t.xp6(2),t.Q6J("disabled",0===n.cart.length))},dependencies:[d.sg,a.Fj,a.wV,a.JJ,a.qQ,a.On,d.H9]}),r})();const y=[{path:"",component:(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-shop-and-cart"]],decls:6,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-md-7","col-12"],[1,"col-md-5","col-12"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-products"),t.qZA(),t.TgZ(4,"div",3),t._UZ(5,"app-cart"),t.qZA()()())},dependencies:[f,b]}),r})()}];let _=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[p.Bz.forChild(y),p.Bz]}),r})();var A=c(4171);let S=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[d.ez,_,a.u5,A.q]}),r})()}}]);